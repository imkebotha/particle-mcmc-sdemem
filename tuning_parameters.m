function [Sig, SD_X0, SD_lB, N, D, eps] = ...
    tuning_parameters(which_data, PF, cor, varargin) 
% Returns empirical posterior covariance for theta and random effects. Also
% returns number of particles, level of discretisation (SDE) and step-size
% for MALA proposals. 
%
% Input:
%   -   which_data  : the dataset to use, "real" or "sim1024"
%   -   PF          : propagation function to use in particle filter
%                     EM = 1; MDB = 2; RB = 3;
%   -   cor         : true if using correlated method, otherwise false
%   -   varargin    : ID, importance density for 
%                     IAPM PRIOR = 1, L-ODE = 2, LAPLACE-MDB = 3

if (which_data == "real")
    % step-size for MALA
    eps = 0.65; 
    
    % particles for IAPM {[standard] ; [correlated]}
    % rows = importance density, cols = propagation function
    Lm = {[200  65  28 ; 185  35  5 ; 185  35  5 ] 
          [90   31  19 ; 65   16  3 ; 65   16  10]};
      
    % particles for CWPM and MPM [standard ; correlated]
    % cols = propagation function
    Nvec = [200 1 1 ; 60 1 1]; 

    Sig = ...
        0.9*[ 0.311935172524090  -0.024315201873416  -0.050992336382447   0.004630766742978  -0.003146480414671  -0.191857190108445   0.140623074534198
         -0.024315201873416   0.863099860405977  -0.012610279741668   0.016119785971027  -0.008360449583341   0.015020465276999   0.050586029907609
         -0.050992336382447  -0.012610279741668   0.010747457727664  -0.000163345597795   0.000130262048747   0.027570402913947  -0.026633949924718
          0.004630766742978   0.016119785971027  -0.000163345597795   0.249510830908005  -0.011004375705563  -0.023240491925190   0.002348314067269
         -0.003146480414671  -0.008360449583341   0.000130262048747  -0.011004375705563   0.110860675824857  -0.001527033761258  -0.004042200180227
         -0.191857190108445   0.015020465276999   0.027570402913947  -0.023240491925190  -0.001527033761258   0.490695676427659  -0.134969468597925
          0.140623074534198   0.050586029907609  -0.026633949924718   0.002348314067269  -0.004042200180227  -0.134969468597925   0.282944927937975];

    SD_X0 = ...
        [0.090998415316899   0.098390849007800   0.102200308601766   0.099825889839544   0.095410882107606  0.096288832353202   0.093507699201081];

    SD_lB = ...
        [1.589996452955851   1.570231068064856   1.134390942764488   0.996704544126414   1.080912324778412  1.033808645846519   1.125595971577931];

else
    % step-size for MALA
    eps = 0.9;
    
    % particles for IAPM {[standard] ; [correlated]}
    % rows = importance density, cols = propagation function
    Lm = {[250  220  40; 220  145  8; 220  145  8] 
      [40  10 10; 9 4 4; 9  10 10]};
  
    % particles for CWPM and MPM [standard ; correlated]
    % cols = propagation function
    Nvec = [460 30 30 ; 65 3 3];

    Sig = ...
       0.9*[0.019595033876279  -0.009708772358596  -0.000411581774249   0.002807783144211   0.002460552482666  -0.011615205427367   0.007729149136623
       -0.009708772358596   0.017295736636368  -0.000115352573782  -0.001103131544293  -0.004016246057315   0.002517322417339  -0.001480077736551
       -0.000411581774249  -0.000115352573782   0.000046077343635  -0.000112183562180   0.000049318955463   0.000603365740362  -0.000367708088988
        0.002807783144211  -0.001103131544293  -0.000112183562180   0.264102220656360  -0.000593670115937  -0.011240565695351   0.003963998365517
        0.002460552482666  -0.004016246057315   0.000049318955463  -0.000593670115937   0.095028617952338  -0.005589798185340   0.004156642745551
       -0.011615205427367   0.002517322417339   0.000603365740362  -0.011240565695351  -0.005589798185340   0.294627895775288  -0.048982116729598
        0.007729149136623  -0.001480077736551  -0.000367708088988   0.003963998365517   0.004156642745551  -0.048982116729598   0.122525621912090];

    SD_X0 = ...
        [0.539987778384213   0.519259356325976   0.532632963323438   0.531493910293818   0.523573226871447   0.531644179699004  0.525383689500207   0.517963234819355   0.523004573020583   0.562369896269095];

    SD_lB = ...
        [1.146952748539692   0.992547737402639   0.689389713906151   0.560084911776572   0.781688043716923   0.072234620502453  0.177867355554450   0.959861513077357   0.909037942716195   1.160712154880793];

end

% level of discretisation for EM approximation and diffusion bridges
D = 10;

if isempty(varargin)
    N = Nvec(cor + 1, PF);
else
    ID = varargin{1};
    N = Lm{cor + 1}(PF, ID);
end

end